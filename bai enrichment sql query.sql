SELECT *,
    CASE
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000123307' THEN 'ASJ Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000154970' THEN 'ALSAC Gift Annuity'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000658200' THEN 'VAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660051' THEN 'ALSAC NEO Deposits'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' THEN 'ALSAC Credit Cards'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660353' THEN 'ALSAC EFT'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000661228' THEN 'ALSAC VAC'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '002466333' THEN 'LA Gaming'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '100334987' THEN 'ALSAC Catalog'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '101137695' THEN 'Up Till Dawn Lockbox Depository'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184920' THEN 'ALSAC Box 20'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184969' THEN 'ALSAC Box 20 Retail'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184976' THEN 'ALSAC Box 50 Retail'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184990' THEN 'Inspiration 4'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184997' THEN 'ALSAC Box 50 Wholesale'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102185011' THEN 'Dormant'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870189' THEN 'Friends & Family Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870385' THEN 'St. Jude Heroes'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870518' THEN 'ALSAC St Jude T&G'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171872226' THEN 'PayPal Acct'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '173645900' THEN 'Telecheck EFTS'
    END AS Account_Name,

    CASE
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000123307' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000154970' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000658200' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660051' THEN 'Stock'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' AND TEXT NOT LIKE 'STRIPE%' THEN 'Credit Card'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' AND TEXT LIKE 'STRIPE%' THEN 'Fintech'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660353' THEN 'EFT'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000661228' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '002466333' THEN 'Credit Card'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '100334987' THEN 'Credit Card'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '101137695' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184920' THEN 'ALSAC Box 20'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184969' THEN 'EFT'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184976' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184990' THEN 'Credit Card'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184997' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102185011' THEN 'Fintech'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870189' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870385' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870518' THEN 'Check/Cash'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171872226' THEN 'Fintech'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '173645900' THEN 'Fintech'
    END AS Settlement_Method,

    CASE
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000123307' THEN 'ALSAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000154970' THEN 'ALSAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000658200' THEN 'FHB Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660051' AND TEXT LIKE 'BROKERAGE%' THEN 'SALE'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660051' AND TEXT NOT LIKE 'BROKERAGE%' THEN TEXT
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' AND TEXT LIKE 'STRIPE%' THEN 'Stripe'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' AND TEXT LIKE '45/34%' THEN 'WorldPay'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' AND TEXT LIKE 'SAMERICANS%' THEN 'American Express'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' AND TEXT LIKE 'SHIFT%' THEN 'SHIFT4'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' AND TEXT LIKE 'BANKCARD%' THEN 'IATS'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660205' AND TEXT LIKE 'CAYAN%' THEN 'CAYAN'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660353' AND TEXT LIKE 'METAVANTE%' THEN 'Bill Pay'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660353' AND TEXT LIKE 'IPAY%' THEN 'BillPay'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660353' AND TEXT LIKE 'SWIRES%' THEN 'Wire'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660353' AND TEXT LIKE 'ST JUDES-SETT-4%' THEN 'Monthly Donors Direct Debit'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660353' THEN 'ACH'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000661228' THEN 'FHB Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '002466333' AND TEXT LIKE 'STRIPE%' THEN 'Stripe'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '002466333' AND TEXT LIKE '45/34%' THEN 'WorldPay'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '002466333' AND TEXT LIKE 'SAMERICANS%' THEN 'American Express'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '002466333' AND TEXT LIKE 'SHIFT%' THEN 'SHIFT4'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '100334987' THEN 'WorldPay'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '101137695' THEN 'FHB Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184920' THEN 'ALSAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184969' THEN 'ACH'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184976' THEN 'ALSAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184990' THEN 'WorldPay'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102184997' THEN 'ALSAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '102185011' THEN 'Stripe'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870189' THEN 'ALSAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870385' THEN 'ALSAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171870518' THEN 'ALSAC Lockbox'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '171872226' THEN 'PayPal'
        WHEN SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '173645900' THEN 'Telecheck'
    END AS Subsettlement_Method
INTO TRUST.BAI_ENRICHED
FROM trust.bai
WHERE TEXT NOT LIKE 'ALSAC SAFEKEEPING -- Non Revenue'
AND NOT (SUBSTRING(CUSTOMER_ACCT_NBR, 7, 9) = '000660051' AND TEXT LIKE 'DEPOSIT%');
